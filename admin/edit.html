<html>
<title>edit blog </title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css" href="./css/jquery.tagsinput.css" />
<script type="text/javascript" src="./js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="./js/jquery.tagsinput.js"></script>
<script type='text/javascript' src='./js/jquery-ui.min.js'></script>
<link rel="stylesheet" type="text/css" href="./css/jquery-ui.css" />


<script type="text/javascript">
    
    function onAddTag(tag) {
        alert("Added a tag: " + tag);
    }
    function onRemoveTag(tag) {
        alert("Removed a tag: " + tag);
    }
    
    function onChangeTag(input,tag) {
        alert("Changed a tag: " + tag);
    }
    
    $(function() {

        $('#tags_1').tagsInput({width:'auto'});

    });

</script>
<body>
<div style="margin-top:200px;margin-left:400px">
<table>
    <tr>
        <td><p><h1>OurBlog</h1></p></td>
        <td style="width: 100px"></td>
        <td><a href="" style="text-decoration:none; "><p>BlogManager</p></a></td>
        <td style="width: 100px"></td>
        <td><a href="./edit.html" style="text-decoration:none; "><p>WriteBlog</p></a></td>
    </tr>

</table>

<hr>

<div style="text-align: left;margin-top: 50px">
<div>
<select id="select" style="width: 30%;height: 30px">
<option value='own' selected="true">own</option> 
<option value='life'>life</option> 
<option value='work'>work</option> 
<option value='play'>play</option> 
</select>
</div>

<div  style="margin-top: 20px">
<p><label>title:</label>

<input  type="text" id="title" name="title" value="" style="height: 40px;width: 60%" placeholder="title" >    
</p>
</div>

<div style="margin-top: 20px">
<p><label>content:</label></p>
<textarea id="content" style="width: 80%;height: 400px;overflow-y:auto" placeholder="article"></textarea>
</div>
<div id="tag" style="margin-top: 30px">
    <form>
    <p><label>添加标签:</label>
    <input id="tags_1" type="text" class="tags" value="mysql,php,linux,apache" /></p>
</form>
</div>
<div id="sub" style="margin-top: 30px">
    <button value="" id="btn" style="width: 80px;height: 40px;border-radius: 5px" onclick="writeblog()">OK</button>
</div>
</div>
<script type="text/javascript">
       function writeblog(){
            var select = document.getElementById("select").value;
            var title = document.getElementById("title").value;
            var content = document.getElementById("content").value;//alert(title);return false;
            var timestamp=new Date().getTime();
            var tag = document.getElementById("tags_1").value;//alert(tag);return false;
            
            if (title == '' || content == '') {alert('please write all options!');return false;}
            var postData = {"title":title,"content":content,"own":select,"create_time":timestamp}, 
            postData = (function(obj){ 
            var str = "";
            for(var prop in obj){
                str += prop + "=" + obj[prop] + "&"
            }
            str=str.substring(0,str.length-1);
            return str;
            })(postData);//alert(postData);return false;
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "./edit.php", true);
            xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xhr.onreadystatechange = function(){
                var XMLHttpReq = xhr;
                if (XMLHttpReq.readyState == 4 && XMLHttpReq.status == 200) {
                    
                         var text = XMLHttpReq.responseText;//console.log(text);return false;
                // alert(text);
                        if(text == true){
                            alert('write file success!');
                            window.location.href="./index.php"; 
                        }
                        else{
                            alert('write file error!');
                            location.reload();

                        }
                        
                    
                }
            };
            xhr.send(postData);

        }

</script>


</body></html>
